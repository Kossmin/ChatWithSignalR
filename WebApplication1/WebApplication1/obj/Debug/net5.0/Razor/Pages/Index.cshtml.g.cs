#pragma checksum "D:\DemoWeb\ChatWithSignalR\WebApplication1\WebApplication1\Pages\Index.cshtml" "{ff1816ec-aa5e-4d10-87f7-6f4963833460}" "e6c2551bda1229655dbf7cad9e7eeae4518a1fb3"
// <auto-generated/>
#pragma warning disable 1591
[assembly: global::Microsoft.AspNetCore.Razor.Hosting.RazorCompiledItemAttribute(typeof(WebApplication1.Pages.Pages_Index), @"mvc.1.0.razor-page", @"/Pages/Index.cshtml")]
namespace WebApplication1.Pages
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using System.Threading.Tasks;
    using Microsoft.AspNetCore.Mvc;
    using Microsoft.AspNetCore.Mvc.Rendering;
    using Microsoft.AspNetCore.Mvc.ViewFeatures;
#nullable restore
#line 1 "D:\DemoWeb\ChatWithSignalR\WebApplication1\WebApplication1\Pages\_ViewImports.cshtml"
using WebApplication1;

#line default
#line hidden
#nullable disable
    [global::Microsoft.AspNetCore.Razor.Hosting.RazorSourceChecksumAttribute(@"SHA1", @"e6c2551bda1229655dbf7cad9e7eeae4518a1fb3", @"/Pages/Index.cshtml")]
    [global::Microsoft.AspNetCore.Razor.Hosting.RazorSourceChecksumAttribute(@"SHA1", @"cd66e6c0b2d0593b97c0d67f6f506054866fe040", @"/Pages/_ViewImports.cshtml")]
    public class Pages_Index : global::Microsoft.AspNetCore.Mvc.RazorPages.Page
    {
        private static readonly global::Microsoft.AspNetCore.Razor.TagHelpers.TagHelperAttribute __tagHelperAttribute_0 = new global::Microsoft.AspNetCore.Razor.TagHelpers.TagHelperAttribute("src", new global::Microsoft.AspNetCore.Html.HtmlString("~/lib/moment.js/moment.min.js"), global::Microsoft.AspNetCore.Razor.TagHelpers.HtmlAttributeValueStyle.DoubleQuotes);
        #line hidden
        #pragma warning disable 0649
        private global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperExecutionContext __tagHelperExecutionContext;
        #pragma warning restore 0649
        private global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperRunner __tagHelperRunner = new global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperRunner();
        #pragma warning disable 0169
        private string __tagHelperStringValueBuffer;
        #pragma warning restore 0169
        private global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperScopeManager __backed__tagHelperScopeManager = null;
        private global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperScopeManager __tagHelperScopeManager
        {
            get
            {
                if (__backed__tagHelperScopeManager == null)
                {
                    __backed__tagHelperScopeManager = new global::Microsoft.AspNetCore.Razor.Runtime.TagHelpers.TagHelperScopeManager(StartTagHelperWritingScope, EndTagHelperWritingScope);
                }
                return __backed__tagHelperScopeManager;
            }
        }
        private global::Microsoft.AspNetCore.Mvc.Razor.TagHelpers.UrlResolutionTagHelper __Microsoft_AspNetCore_Mvc_Razor_TagHelpers_UrlResolutionTagHelper;
        #pragma warning disable 1998
        public async override global::System.Threading.Tasks.Task ExecuteAsync()
        {
#nullable restore
#line 3 "D:\DemoWeb\ChatWithSignalR\WebApplication1\WebApplication1\Pages\Index.cshtml"
  
    ViewData["Title"] = "Home page";

#line default
#line hidden
#nullable disable
            WriteLiteral(@"
<h2>Chat</h2>
<div class=""container"" id=""container"">
    <div id=""chatConnectionInfo"">
        <strong>Connecting.....</strong>
    </div>
    <div id=""chatPannel"">
        <input type=""hidden"" id=""displayname"" />
        <ul id=""discussion"">
        </ul>
        <input type=""text"" id=""message"" />
        <input type=""button"" id=""sendmessage"" value=""Send"" onclick=""sendMessage()"" />
        <input type=""button"" id=""changeroom"" value=""Change Room"" onclick=""leaveRoom()"" />
    </div>
</div>

<script src=""https://cdnjs.cloudflare.com/ajax/libs/microsoft-signalr/3.1.7/signalr.min.js""></script>
");
            __tagHelperExecutionContext = __tagHelperScopeManager.Begin("script", global::Microsoft.AspNetCore.Razor.TagHelpers.TagMode.StartTagAndEndTag, "e6c2551bda1229655dbf7cad9e7eeae4518a1fb34125", async() => {
            }
            );
            __Microsoft_AspNetCore_Mvc_Razor_TagHelpers_UrlResolutionTagHelper = CreateTagHelper<global::Microsoft.AspNetCore.Mvc.Razor.TagHelpers.UrlResolutionTagHelper>();
            __tagHelperExecutionContext.Add(__Microsoft_AspNetCore_Mvc_Razor_TagHelpers_UrlResolutionTagHelper);
            __tagHelperExecutionContext.AddHtmlAttribute(__tagHelperAttribute_0);
            await __tagHelperRunner.RunAsync(__tagHelperExecutionContext);
            if (!__tagHelperExecutionContext.Output.IsContentModified)
            {
                await __tagHelperExecutionContext.SetOutputContentAsync();
            }
            Write(__tagHelperExecutionContext.Output);
            __tagHelperExecutionContext = __tagHelperScopeManager.End();
            WriteLiteral(@"
<script>
    const connection = new signalR.HubConnectionBuilder()
        .withUrl(""/chathub"")
        .build();
    let chatterName = prompt(""Your name: "");
    let chatPannel = document.getElementById(""chatPannel"");
    let chatConnectionInfo = document.getElementById(""chatConnectionInfo"");
    let container = document.getElementById(""container"");
        let RoomIdContext;
        connection.on(""ReceiveMessage"", receiveMessage);
        connection.on(""SendId"", RoomID);
    connection.on(""ReceiveMessages"", addMessages);

    function addMessages(messages) {
        if (!messages) return;

        messages.forEach(function (m) {
            receiveMessage(m.chatterName, m.content, m.sendAt);
        });
    }


        function RoomID(roomId) {
            addRoomId(roomId);
            RoomIdContext = roomId;
        }

    function addRoomId(roomId) {
        let newdiv = document.createElement(""div"");
        newdiv.textContent = roomId;
        container.insertBefore(newd");
            WriteLiteral(@"iv, container.children[0]);
    }

    connection.onclose(function () {
        onDisconnected();
        setTimeout(onConnection(), 5000);
    })


    function onConnection() {
        connection.start()
            .then(onConnected)
            .catch(function (err) {
                console.error(err);
            });
    }

    function onDisconnected() {
        chatPannel.style = ""filter :blur(2px)"";;
        chatConnectionInfo.style = ""display:block;"";
        let button = document.getElementById(""sendmessage"");
        button.disable = false;
    }

    function onConnected() {
        chatPannel.style = ""filter :blur(0);"";
        chatConnectionInfo.style = ""display:none;"";
        let content = document.getElementById(""message"");
        content.focus();

        let button = document.getElementById(""sendmessage"");
        button.disable = true;
    }

    onConnection();

    function sendMessage() {
        let content = document.getElementById(""message"");
 ");
            WriteLiteral(@"       let text = content.value;

     
        content.value = """";
        content.focus();
        connection.invoke(""SendMessage"", chatterName, text, RoomIdContext);
    }

    function receiveMessage(chattername, content, sendAt) {
        let listitem = document.createElement(""li"");
        let spanName = document.createElement(""span"");
        spanName.textContent = chattername + ""  "";
        spanName.style = ""padding-right: 15px"";
        listitem.appendChild(spanName);

        let spanText = document.createElement(""span"");
        spanText.style = ""padding-right: 30px"";
        spanText.textContent = content + ""  "";
        listitem.appendChild(spanText);


        let spanTime = document.createElement(""span"");
        sendAt = moment(sendAt).format('LT');
        spanTime.textContent = sendAt;
        listitem.appendChild(spanTime);

        let ul = document.getElementById(""discussion"");
        ul.appendChild(listitem);

    }

    function leaveRoom() {
        Ro");
            WriteLiteral(@"omIdContext = prompt(""Room id: "");
        if (RoomIdContext === null) {
            return;
        }
        else {
            let chatHistory = document.getElementById(""discussion"");
            while (chatHistory.firstChild) {
                chatHistory.removeChild(chatHistory.lastChild);
            }
            connection.invoke(""LeaveRoom"", RoomIdContext);
        }
    }

</script>
");
        }
        #pragma warning restore 1998
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.ViewFeatures.IModelExpressionProvider ModelExpressionProvider { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IUrlHelper Url { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.IViewComponentHelper Component { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IJsonHelper Json { get; private set; }
        [global::Microsoft.AspNetCore.Mvc.Razor.Internal.RazorInjectAttribute]
        public global::Microsoft.AspNetCore.Mvc.Rendering.IHtmlHelper<IndexModel> Html { get; private set; }
        public global::Microsoft.AspNetCore.Mvc.ViewFeatures.ViewDataDictionary<IndexModel> ViewData => (global::Microsoft.AspNetCore.Mvc.ViewFeatures.ViewDataDictionary<IndexModel>)PageContext?.ViewData;
        public IndexModel Model => ViewData.Model;
    }
}
#pragma warning restore 1591
